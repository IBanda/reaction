"use strict";

var Element = require("./element"),
    ReactClass = require("./reactClass"),
    nameUtilities = require("./utilities/name"),
    arrayUtilities = require("./utilities/array"),
    ReactComponent = require("./reactComponent"),
    ReactClassElement = require("./element/react/class"),
    ReactFunctionElement = require("./element/react/function"),
    ReactComponentElement = require("./element/react/component"),
    VirtualDOMTextElement = require("./element/virtualDOMNode/textElement"),
    VirtualDOMHTMLElement = require("./element/virtualDOMNode/element/html"),
    VirtualDOMSVGElement = require("./element/virtualDOMNode/element/svg");

var flatten = arrayUtilities.flatten,
    isSVGTagName = nameUtilities.isSVGTagName;

function createClass(object) {
  return ReactClass.create(object);
}

function createElement(firstArgument, properties) {
  var element = null;

  if (firstArgument !== undefined) {
    for (var _len = arguments.length, childArguments = new Array(_len > 2 ? _len - 2 : 0), _key = 2; _key < _len; _key++) {
      childArguments[_key - 2] = arguments[_key];
    }

    var children = childrenFromChildArguments(childArguments),
        props = Object.assign({}, properties, {
      children: children
    });

    if (false) {///
    } else if (typeof firstArgument === "string") {
      var tagName = firstArgument,
          ///
      virtualDOMElement = isSVGTagName(tagName) ? new VirtualDOMSVGElement(tagName, props) : new VirtualDOMHTMLElement(tagName, props);
      element = virtualDOMElement; ///
    } else if (firstArgument instanceof ReactClass) {
      var reactClass = firstArgument,
          ///
      reactClassElement = new ReactClassElement(reactClass, props);
      element = reactClassElement; ///

      var mixins = reactClass.mixins;
      assignMixins(mixins, element);
    } else if (isSubclassOf(firstArgument, ReactComponent)) {
      var _ReactComponent = firstArgument,
          ///
      reactComponent = new _ReactComponent(),
          reactComponentElement = new ReactComponentElement(reactComponent, props);
      element = reactComponentElement; ///

      assignReactComponentMixins(_ReactComponent, element);
    } else if (typeof firstArgument === "function") {
      var reactFunction = firstArgument,
          ///
      reactFunctionElement = new ReactFunctionElement(reactFunction, props);
      element = reactFunctionElement; ///
    }
  }

  return element;
}

var Component = ReactComponent,
    ///
React = {
  Component: Component,
  createClass: createClass,
  createElement: createElement
};
module.exports = React;

function childrenFromChildArguments(childArguments) {
  childArguments = flatten(childArguments); ///

  var children = childArguments.map(function (childArgument) {
    var child;

    if (isSubclassOf(childArgument.constructor, Element)) {
      ///
      child = childArgument; ///
    } else {
      var text = childArgument,
          ///
      virtualDOMTextElement = new VirtualDOMTextElement(text);
      child = virtualDOMTextElement;
    }

    return child;
  });
  return children;
}

function assignReactComponentMixins(reactComponent, element) {
  var _reactComponent = reactComponent,
      mixins = _reactComponent.mixins;
  reactComponent = Object.getPrototypeOf(reactComponent); ///

  if (reactComponent !== ReactComponent) {
    assignReactComponentMixins(reactComponent, element);
  }

  assignMixins(mixins, element);
}

function assignMixins(mixins, element) {
  if (mixins) {
    mixins.forEach(function (mixin) {
      var name = mixin.name;
      element[name] = mixin.bind(element);
    });
  }
}

function isSubclassOf(argument, Class) {
  var subclass = false;

  if (argument.name === Class.name) {
    ///
    subclass = true;
  } else {
    argument = Object.getPrototypeOf(argument); ///

    if (argument !== null) {
      subclass = isSubclassOf(argument, Class);
    }
  }

  return subclass;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJlYWN0LmpzIl0sIm5hbWVzIjpbIkVsZW1lbnQiLCJyZXF1aXJlIiwiUmVhY3RDbGFzcyIsIm5hbWVVdGlsaXRpZXMiLCJhcnJheVV0aWxpdGllcyIsIlJlYWN0Q29tcG9uZW50IiwiUmVhY3RDbGFzc0VsZW1lbnQiLCJSZWFjdEZ1bmN0aW9uRWxlbWVudCIsIlJlYWN0Q29tcG9uZW50RWxlbWVudCIsIlZpcnR1YWxET01UZXh0RWxlbWVudCIsIlZpcnR1YWxET01IVE1MRWxlbWVudCIsIlZpcnR1YWxET01TVkdFbGVtZW50IiwiZmxhdHRlbiIsImlzU1ZHVGFnTmFtZSIsImNyZWF0ZUNsYXNzIiwib2JqZWN0IiwiY3JlYXRlIiwiY3JlYXRlRWxlbWVudCIsImZpcnN0QXJndW1lbnQiLCJwcm9wZXJ0aWVzIiwiZWxlbWVudCIsInVuZGVmaW5lZCIsImNoaWxkQXJndW1lbnRzIiwiY2hpbGRyZW4iLCJjaGlsZHJlbkZyb21DaGlsZEFyZ3VtZW50cyIsInByb3BzIiwiT2JqZWN0IiwiYXNzaWduIiwidGFnTmFtZSIsInZpcnR1YWxET01FbGVtZW50IiwicmVhY3RDbGFzcyIsInJlYWN0Q2xhc3NFbGVtZW50IiwibWl4aW5zIiwiYXNzaWduTWl4aW5zIiwiaXNTdWJjbGFzc09mIiwicmVhY3RDb21wb25lbnQiLCJyZWFjdENvbXBvbmVudEVsZW1lbnQiLCJhc3NpZ25SZWFjdENvbXBvbmVudE1peGlucyIsInJlYWN0RnVuY3Rpb24iLCJyZWFjdEZ1bmN0aW9uRWxlbWVudCIsIkNvbXBvbmVudCIsIlJlYWN0IiwibW9kdWxlIiwiZXhwb3J0cyIsIm1hcCIsImNoaWxkQXJndW1lbnQiLCJjaGlsZCIsImNvbnN0cnVjdG9yIiwidGV4dCIsInZpcnR1YWxET01UZXh0RWxlbWVudCIsImdldFByb3RvdHlwZU9mIiwiZm9yRWFjaCIsIm1peGluIiwibmFtZSIsImJpbmQiLCJhcmd1bWVudCIsIkNsYXNzIiwic3ViY2xhc3MiXSwibWFwcGluZ3MiOiJBQUFBOztBQUVB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Q0FESyxDQUN1Qzs7QUFFNUMsUUFBSUEsUUFBUSxLQUFLLElBQWpCLEVBQXVCO0FBQ3JCRSxNQUFBQSxRQUFRLEdBQUd2QixZQUFZLENBQUNxQixRQUFELEVBQVdDLEtBQVgsQ0FBdkI7QUFDRDtBQUNGOztBQUVELFNBQU9DLFFBQVA7QUFDRCIsInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuXG5jb25zdCBFbGVtZW50ID0gcmVxdWlyZShcIi4vZWxlbWVudFwiKSxcbiAgICAgIFJlYWN0Q2xhc3MgPSByZXF1aXJlKFwiLi9yZWFjdENsYXNzXCIpLFxuICAgICAgbmFtZVV0aWxpdGllcyA9IHJlcXVpcmUoXCIuL3V0aWxpdGllcy9uYW1lXCIpLFxuICAgICAgYXJyYXlVdGlsaXRpZXMgPSByZXF1aXJlKFwiLi91dGlsaXRpZXMvYXJyYXlcIiksXG4gICAgICBSZWFjdENvbXBvbmVudCA9IHJlcXVpcmUoXCIuL3JlYWN0Q29tcG9uZW50XCIpLFxuICAgICAgUmVhY3RDbGFzc0VsZW1lbnQgPSByZXF1aXJlKFwiLi9lbGVtZW50L3JlYWN0L2NsYXNzXCIpLFxuICAgICAgUmVhY3RGdW5jdGlvbkVsZW1lbnQgPSByZXF1aXJlKFwiLi9lbGVtZW50L3JlYWN0L2Z1bmN0aW9uXCIpLFxuICAgICAgUmVhY3RDb21wb25lbnRFbGVtZW50ID0gcmVxdWlyZShcIi4vZWxlbWVudC9yZWFjdC9jb21wb25lbnRcIiksXG4gICAgICBWaXJ0dWFsRE9NVGV4dEVsZW1lbnQgPSByZXF1aXJlKFwiLi9lbGVtZW50L3ZpcnR1YWxET01Ob2RlL3RleHRFbGVtZW50XCIpLFxuICAgICAgVmlydHVhbERPTUhUTUxFbGVtZW50ID0gcmVxdWlyZShcIi4vZWxlbWVudC92aXJ0dWFsRE9NTm9kZS9lbGVtZW50L2h0bWxcIiksXG4gICAgICBWaXJ0dWFsRE9NU1ZHRWxlbWVudCA9IHJlcXVpcmUoXCIuL2VsZW1lbnQvdmlydHVhbERPTU5vZGUvZWxlbWVudC9zdmdcIik7XG5cbmNvbnN0IHsgZmxhdHRlbiB9ID0gYXJyYXlVdGlsaXRpZXMsXG4gICAgICB7IGlzU1ZHVGFnTmFtZSB9ID0gbmFtZVV0aWxpdGllcztcblxuZnVuY3Rpb24gY3JlYXRlQ2xhc3Mob2JqZWN0KSB7XG4gIHJldHVybiBSZWFjdENsYXNzLmNyZWF0ZShvYmplY3QpO1xufVxuXG5mdW5jdGlvbiBjcmVhdGVFbGVtZW50KGZpcnN0QXJndW1lbnQsIHByb3BlcnRpZXMsIC4uLmNoaWxkQXJndW1lbnRzKSB7XG4gIGxldCBlbGVtZW50ID0gbnVsbDtcblxuICBpZiAoZmlyc3RBcmd1bWVudCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgY29uc3QgY2hpbGRyZW4gPSBjaGlsZHJlbkZyb21DaGlsZEFyZ3VtZW50cyhjaGlsZEFyZ3VtZW50cyksXG4gICAgICAgICAgcHJvcHMgPSBPYmplY3QuYXNzaWduKHt9LCBwcm9wZXJ0aWVzLCB7XG4gICAgICAgICAgICBjaGlsZHJlblxuICAgICAgICAgIH0pO1xuXG4gICAgaWYgKGZhbHNlKSB7XG4gICAgICAvLy9cbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBmaXJzdEFyZ3VtZW50ID09PSBcInN0cmluZ1wiKSB7XG4gICAgICBjb25zdCB0YWdOYW1lID0gZmlyc3RBcmd1bWVudCwgIC8vL1xuICAgICAgICAgICAgdmlydHVhbERPTUVsZW1lbnQgPSBpc1NWR1RhZ05hbWUodGFnTmFtZSkgP1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBWaXJ0dWFsRE9NU1ZHRWxlbWVudCh0YWdOYW1lLCBwcm9wcykgOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3IFZpcnR1YWxET01IVE1MRWxlbWVudCh0YWdOYW1lLCBwcm9wcyk7XG5cbiAgICAgIGVsZW1lbnQgPSB2aXJ0dWFsRE9NRWxlbWVudCAvLy9cbiAgICB9IGVsc2UgaWYgKGZpcnN0QXJndW1lbnQgaW5zdGFuY2VvZiBSZWFjdENsYXNzKSB7XG4gICAgICBjb25zdCByZWFjdENsYXNzID0gZmlyc3RBcmd1bWVudCwgLy8vXG4gICAgICAgICAgICByZWFjdENsYXNzRWxlbWVudCA9IG5ldyBSZWFjdENsYXNzRWxlbWVudChyZWFjdENsYXNzLCBwcm9wcyk7XG5cbiAgICAgIGVsZW1lbnQgPSByZWFjdENsYXNzRWxlbWVudDsgIC8vL1xuXG4gICAgICBjb25zdCB7IG1peGlucyB9ID0gcmVhY3RDbGFzcztcblxuICAgICAgYXNzaWduTWl4aW5zKG1peGlucywgZWxlbWVudCk7XG4gICAgfSBlbHNlIGlmIChpc1N1YmNsYXNzT2YoZmlyc3RBcmd1bWVudCwgUmVhY3RDb21wb25lbnQpKSB7XG4gICAgICBjb25zdCBSZWFjdENvbXBvbmVudCA9IGZpcnN0QXJndW1lbnQsICAvLy9cbiAgICAgICAgICAgIHJlYWN0Q29tcG9uZW50ID0gbmV3IFJlYWN0Q29tcG9uZW50KCksXG4gICAgICAgICAgICByZWFjdENvbXBvbmVudEVsZW1lbnQgPSBuZXcgUmVhY3RDb21wb25lbnRFbGVtZW50KHJlYWN0Q29tcG9uZW50LCBwcm9wcyk7XG5cbiAgICAgIGVsZW1lbnQgPSByZWFjdENvbXBvbmVudEVsZW1lbnQ7ICAvLy9cblxuICAgICAgYXNzaWduUmVhY3RDb21wb25lbnRNaXhpbnMoUmVhY3RDb21wb25lbnQsIGVsZW1lbnQpO1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIGZpcnN0QXJndW1lbnQgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgY29uc3QgcmVhY3RGdW5jdGlvbiA9IGZpcnN0QXJndW1lbnQsICAvLy9cbiAgICAgICAgICAgIHJlYWN0RnVuY3Rpb25FbGVtZW50ID0gbmV3IFJlYWN0RnVuY3Rpb25FbGVtZW50KHJlYWN0RnVuY3Rpb24sIHByb3BzKTtcblxuICAgICAgZWxlbWVudCA9IHJlYWN0RnVuY3Rpb25FbGVtZW50OyAvLy9cbiAgICB9XG4gIH1cblxuICByZXR1cm4gZWxlbWVudDtcbn1cblxuY29uc3QgQ29tcG9uZW50ID0gUmVhY3RDb21wb25lbnQsIC8vL1xuICAgICAgUmVhY3QgPSB7XG4gICAgICAgIENvbXBvbmVudCxcbiAgICAgICAgY3JlYXRlQ2xhc3MsXG4gICAgICAgIGNyZWF0ZUVsZW1lbnRcbiAgICAgIH07XG5cbm1vZHVsZS5leHBvcnRzID0gUmVhY3Q7XG5cbmZ1bmN0aW9uIGNoaWxkcmVuRnJvbUNoaWxkQXJndW1lbnRzKGNoaWxkQXJndW1lbnRzKSB7XG4gIGNoaWxkQXJndW1lbnRzID0gZmxhdHRlbihjaGlsZEFyZ3VtZW50cyk7IC8vL1xuXG4gIGNvbnN0IGNoaWxkcmVuID0gY2hpbGRBcmd1bWVudHMubWFwKChjaGlsZEFyZ3VtZW50KSA9PiB7XG4gICAgbGV0IGNoaWxkO1xuXG4gICAgaWYgKGlzU3ViY2xhc3NPZihjaGlsZEFyZ3VtZW50LmNvbnN0cnVjdG9yLCBFbGVtZW50KSkgeyAvLy9cbiAgICAgIGNoaWxkID0gY2hpbGRBcmd1bWVudDsgIC8vL1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zdCB0ZXh0ID0gY2hpbGRBcmd1bWVudCwgLy8vXG4gICAgICAgICAgICB2aXJ0dWFsRE9NVGV4dEVsZW1lbnQgPSBuZXcgVmlydHVhbERPTVRleHRFbGVtZW50KHRleHQpO1xuXG4gICAgICBjaGlsZCA9IHZpcnR1YWxET01UZXh0RWxlbWVudDtcbiAgICB9XG5cbiAgICByZXR1cm4gY2hpbGQ7XG4gIH0pO1xuXG4gIHJldHVybiBjaGlsZHJlbjtcbn1cblxuZnVuY3Rpb24gYXNzaWduUmVhY3RDb21wb25lbnRNaXhpbnMocmVhY3RDb21wb25lbnQsIGVsZW1lbnQpIHtcbiAgY29uc3QgeyBtaXhpbnMgfSA9IHJlYWN0Q29tcG9uZW50O1xuXG4gIHJlYWN0Q29tcG9uZW50ID0gT2JqZWN0LmdldFByb3RvdHlwZU9mKHJlYWN0Q29tcG9uZW50KTsgLy8vXG5cbiAgaWYgKHJlYWN0Q29tcG9uZW50ICE9PSBSZWFjdENvbXBvbmVudCkge1xuICAgIGFzc2lnblJlYWN0Q29tcG9uZW50TWl4aW5zKHJlYWN0Q29tcG9uZW50LCBlbGVtZW50KTtcbiAgfVxuXG4gIGFzc2lnbk1peGlucyhtaXhpbnMsIGVsZW1lbnQpO1xufVxuXG5mdW5jdGlvbiBhc3NpZ25NaXhpbnMobWl4aW5zLCBlbGVtZW50KSB7XG4gIGlmIChtaXhpbnMpIHtcbiAgICBtaXhpbnMuZm9yRWFjaCgobWl4aW4pID0+IHtcbiAgICAgIGNvbnN0IHsgbmFtZSB9ID0gbWl4aW47XG5cbiAgICAgIGVsZW1lbnRbbmFtZV0gPSBtaXhpbi5iaW5kKGVsZW1lbnQpO1xuICAgIH0pO1xuICB9XG59XG5cbmZ1bmN0aW9uIGlzU3ViY2xhc3NPZihhcmd1bWVudCwgQ2xhc3MpIHtcbiAgbGV0IHN1YmNsYXNzID0gZmFsc2U7XG5cbiAgaWYgKGFyZ3VtZW50Lm5hbWUgPT09IENsYXNzLm5hbWUpIHsgLy8vXG4gICAgc3ViY2xhc3MgPSB0cnVlO1xuICB9IGVsc2Uge1xuICAgIGFyZ3VtZW50ID0gT2JqZWN0LmdldFByb3RvdHlwZU9mKGFyZ3VtZW50KTsgLy8vXG5cbiAgICBpZiAoYXJndW1lbnQgIT09IG51bGwpIHtcbiAgICAgIHN1YmNsYXNzID0gaXNTdWJjbGFzc09mKGFyZ3VtZW50LCBDbGFzcyk7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHN1YmNsYXNzO1xufVxuIl19